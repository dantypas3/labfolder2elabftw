
*** Begin Patch
*** Update File: coordinator.py
@@
     def run (self) -> None:
@@
-        transformer = Transformer(entries=entries,
+        transformer = Transformer(entries=entries,
                                   fetcher=self._client,
                                   importer=self._importer,
                                   isa_ids_list=self._isa_ids,
                                   namelist=self._namelist
                                   )
@@
-        for project_id, project_entries in data_by_project.items():
+        # Prepare a single XHTML export up-front (if possible)
+        xhtml_root = None
+        try:
+            self.logger.info("Creating Labfolder XHTML export (full account)…")
+            export_id = self._client.create_xhtml_export(include_hidden_items=False)
+            self._client.wait_for_xhtml_export(export_id)
+            tmp_zip = Path(tempfile.gettempdir()) / f"labfolder_xhtml_{export_id}.zip"
+            self._client.download_xhtml_export(export_id, tmp_zip)
+            xhtml_root = Path(tempfile.gettempdir()) / f"labfolder_xhtml_{export_id}"
+            self._client.extract_zip(tmp_zip, xhtml_root)
+            self.logger.info("XHTML export ready at %s", xhtml_root)
+        except Exception as e:
+            self.logger.warning("Skipping XHTML attachments (reason: %s)", e)
+            xhtml_root = None
+
+        for project_id, project_entries in data_by_project.items():
             self.logger.info(
                 "Importing project %r with %d entries…",
                 project_id, len(project_entries)
             )
             html_blocks = transformer.transform_projects_content(
                 project_entries,
-                category=83
+                category=83,
+                xhtml_root=xhtml_root

             )
*** End Patch
